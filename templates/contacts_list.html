{% extends "base.html" %}

{% block title %}Kontakte{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Kontakte (Global, Chronologisch ↓)</h1>
    <a href="/" class="btn-back">← Zurück zur Startseite</a>
</div>

<section class="card">
    <div class="card-header">
        <h2>Kontakte filtern</h2>
        <div class="filter-buttons">
            <a href="{{ url_for('contacts.list_contacts') }}" 
               class="btn-filter {% if not channel_filter %}active-filter{% endif %}">Alle</a>
            <a href="{{ url_for('contacts.list_contacts', channel='Telefon') }}" 
               class="btn-filter {% if channel_filter == 'Telefon' %}active-filter{% endif %}">Telefon</a>
            <a href="{{ url_for('contacts.list_contacts', channel='E-Mail') }}" 
               class="btn-filter {% if channel_filter == 'E-Mail' %}active-filter{% endif %}">E-Mail</a>
            <a href="{{ url_for('contacts.list_contacts', channel='Meeting') }}" 
               class="btn-filter {% if channel_filter == 'Meeting' %}active-filter{% endif %}">Meeting</a>
            <a href="{{ url_for('contacts.list_contacts', channel='Chat') }}" 
               class="btn-filter {% if channel_filter == 'Chat' %}active-filter{% endif %}">Chat</a>
        </div>
    </div>
    <div class="table-responsive">
        <table class="data-table">
            <thead>
                <tr>
                    <th>Datum/Zeit</th>
                    <th>Kunde</th>
                    <th>Art</th>
                    <th>Betreff</th>
                </tr>
            </thead>
            <tbody>
                {% for contact in contacts %}
                <tr onclick="window.location=`{{ url_for('customers.customer_detail', customer_id=contact.customer_id) }}`">
                    <td>{{ contact.contact_time.strftime('%Y-%m-%d %H:%M') }}</td>
                    <td>{{ contact.customer_name }}</td>
                    <td><span class="channel-badge channel-{{ contact.channel|lower }}">{{ contact.channel }}</span></td>
                    <td>{{ contact.subject or '-' }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% if not contacts %}
    <div style="padding: 2rem; text-align: center; color: #7f8c8d;">
        Keine Kontakte gefunden.
    </div>
    {% endif %}
    
    <!-- Pagination -->
    <div class="pagination">
        {% if has_prev %}
        <a href="{{ url_for('contacts.list_contacts', channel=channel_filter, page=page-1) }}" class="btn-secondary">← Vorherige</a>
        {% endif %}
        <span class="page-info">Seite {{ page }}</span>
        {% if has_next %}
        <a href="{{ url_for('contacts.list_contacts', channel=channel_filter, page=page+1) }}" class="btn-secondary">Nächste →</a>
        {% endif %}
    </div>
</section>

<style>
.page-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
}

.page-header h1 {
    font-size: 2rem;
    color: #2c3e50;
}

.pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1rem;
    padding: 1.5rem;
}

.page-info {
    color: #7f8c8d;
    font-weight: 500;
}

.active-filter {
    background-color: #3498db !important;
    color: white !important;
}
</style>
{% endblock %}